<html lang="en">
<head>
<title>Functions of One Variable - Untitled</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Untitled">
<meta name="generator" content="makeinfo 4.8">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Numerical-Integration.html#Numerical-Integration" title="Numerical Integration">
<link rel="next" href="Functions-of-Multiple-Variables.html#Functions-of-Multiple-Variables" title="Functions of Multiple Variables">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
td,p {
font-family: arial,sans-serif;
color: #000000;
}

body {
  background: white;
  color: #000000;
  font-family: arial,sans-serif;
  font-weight: normal;
  font-size: medium;
  min-width: 500px;
  max-width: 950px;
  margin-left: 3%;
  margin-right: 12%;
}

a:link {
color: #0050fa;
}

a:visited {
color: #1188ff;
}

.code {
margin-left: 30px;
margin-right: 30px;
background-color: #d0d0d0;
color: #000000;
}

/* the navigation choices at the bottom of the page. */

div#nav {
color: #000000;
float: left;
font-family: arial,sans-serif;
font-size: 0.75em;
margin: 1em 0 0 1em;
padding: 0;
position: fixed;
text-align: left;
width: 10em;
}

div#nav a {
background-color: #dde4ff;
border: 1px solid;
border-color: #10a0ff;
display: block;
padding: 0.2em 0.5em 0.2em 0.5em ;
text-decoration: none;
color: #1155dd;
}

div#nav a:hover {
background-color: #f5f5ff;
}

div#nav div#currentnav {
background-color: #ccccdd;
border: solid;
border-left-width: 1px;
border-top-width: 1px;
border-bottom-width: 1px;
border-right-width: 0px;
border-color: #10a0ff;
display: block;
padding: 0.2em 0.5em 0.2em 0.5em ;
text-align: right;
}

/* the page content */

div#content {
  position: relative;
  left: 11em;
  width: 80%;
}

div.section {
  clear: both;
}

/* For all page footers */
div#footer {
clear: both;
font-size: x-small;
text-align: center;
color: #606060;
}

/* the title bar */

div#title {
width: 100%;
clear: both;
}

div#title h1 {
background-color: #ffffff;
border-bottom: 5px solid #33ccff;
font-size: xx-large;
color: #10a0ff;
padding: 0;
margin: 0;
}

/* The blue title bar on non-main pages */

.header {
color: #ffffff;
background-color: #10a0ff;
font-family: arial,sans-serif;
padding: 0;
font-size: medium;
font-weight: bold;
border: 3px solid #10a0ff;
}

/* For the download page */

/* descriptions of versions available */
dt {
font-weight: bold;
}

dd {
font-family: arial,sans-serif;
}

/* Highlighting the code download sections */
.download {
background-color: #d0e0ff;
}

caption {
display: none;
}

th {
text-align: left;
}

/* Changes for Octave Wiki */

h1 {
background-color: #10a0ff;
color: #ffffff;
font-size: xx-large;
padding: 2em;
margin: 8em;
}

h2 {
background-color: #10a0ff;
color: #ffffff;
font-size: 1.2em;
padding: 2px;
margin-top: 5px;
}

h3 {
background-color: #10a0ff;
color: #ffffff;
font-size: 1.1em;
padding: 2px;
margin-top: 5px;
}

h4,h5,h6 {
color: #606060;
font-size: large;
padding: 2px;
margin-top: 5px;
}

/* for links in the header */
h1 a {
color: #ffffff;
}

#im {
float: right;
margin: 10px;
border: 2px solid #000000;
}

#iml {
margin: 10px;
float: right;
border: 2px solid #000000;
clear: right;
}

img.left { float:left; margin:1em; }
img.right { float:right; margin:1em; }
img.middle { text-align:center; margin:1em; }

img.logo { float: right; clear: right; border-style:none; }

pre {
border: #777777 1px solid;
padding: 0.5em;
margin-left: 1em;
margin-right: 2em;
white-space: pre;
background-color: #e6e6e6;
color: black;
}

blockquote.note {
border: #777777 1px solid;
padding: 0.5em;
margin-left: 1em;
margin-right: 2em;
background-color: #e6e6e6;
color: black;
}
--></style>
</head>
<body>
<div class="node">
<p>
<a name="Functions-of-One-Variable"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="Functions-of-Multiple-Variables.html#Functions-of-Multiple-Variables">Functions of Multiple Variables</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Numerical-Integration.html#Numerical-Integration">Numerical Integration</a>
<hr>
</div>

<h3 class="section">23.1 Functions of One Variable</h3>

<p>Octave supports three different algorithms for computing the integral
of a function f over the interval from a to b. 
These are

     <dl>
<dt><code>quad</code><dd>Numerical integration based on Gaussian quadrature.

     <br><dt><code>quadl</code><dd>Numerical integration using an adaptive Lobatto rule.

     <br><dt><code>trapz</code><dd>Numerical integration using the trapezodial method. 
</dl>

<p class="noindent">Besides these functions Octave also allows you to perform cumulative
numerical integration using the trapezodial method through the
<code>cumtrapz</code> function.

   <p><a name="doc_002dquad"></a>

<div class="defun">
&mdash; Loadable Function: [<var>v</var>, <var>ier</var>, <var>nfun</var>, <var>err</var>] = <b>quad</b> (<var>f, a, b, tol, sing</var>)<var><a name="index-quad-1244"></a></var><br>
<blockquote><p>Integrate a nonlinear function of one variable using Quadpack. 
The first argument is the name of the  function, the function handle or
the inline function to call to compute the value of the integrand.  It
must have the form

     <pre class="example">          y = f (x)
     </pre>
        <p class="noindent">where <var>y</var> and <var>x</var> are scalars.

        <p>The second and third arguments are limits of integration.  Either or
both may be infinite.

        <p>The optional argument <var>tol</var> is a vector that specifies the desired
accuracy of the result.  The first element of the vector is the desired
absolute tolerance, and the second element is the desired relative
tolerance.  To choose a relative test only, set the absolute
tolerance to zero.  To choose an absolute test only, set the relative
tolerance to zero.

        <p>The optional argument <var>sing</var> is a vector of values at which the
integrand is known to be singular.

        <p>The result of the integration is returned in <var>v</var> and <var>ier</var>
contains an integer error code (0 indicates a successful integration). 
The value of <var>nfun</var> indicates how many function evaluations were
required, and <var>err</var> contains an estimate of the error in the
solution.

        <p>You can use the function <code>quad_options</code> to set optional
parameters for <code>quad</code>.

        <p>It should be noted that since <code>quad</code> is written in Fortran it
cannot be called recursively. 
</p></blockquote></div>

   <p><a name="doc_002dquad_005foptions"></a>

<div class="defun">
&mdash; Loadable Function:  <b>quad_options</b> (<var>opt, val</var>)<var><a name="index-quad_005foptions-1245"></a></var><br>
<blockquote><p>When called with two arguments, this function
allows you set options parameters for the function <code>quad</code>. 
Given one argument, <code>quad_options</code> returns the value of the
corresponding option.  If no arguments are supplied, the names of all
the available options and their current values are displayed.

        <p>Options include

          <dl>
<dt><code>"absolute tolerance"</code><dd>Absolute tolerance; may be zero for pure relative error test. 
<br><dt><code>"relative tolerance"</code><dd>Nonnegative relative tolerance.  If the absolute tolerance is zero,
the relative tolerance must be greater than or equal to
<code>max (50*eps, 0.5e-28)</code>. 
</dl>
        </p></blockquote></div>

   <p>Here is an example of using <code>quad</code> to integrate the function

<pre class="example">       <var>f</var>(<var>x</var>) = <var>x</var> * sin (1/<var>x</var>) * sqrt (abs (1 - <var>x</var>))
</pre>
   <p class="noindent">from <var>x</var> = 0 to <var>x</var> = 3.

   <p>This is a fairly difficult integration (plot the function over the range
of integration to see why).

   <p>The first step is to define the function:

<pre class="example">     function y = f (x)
       y = x .* sin (1 ./ x) .* sqrt (abs (1 - x));
     endfunction
</pre>
   <p>Note the use of the `dot' forms of the operators.  This is not necessary
for the call to <code>quad</code>, but it makes it much easier to generate a
set of points for plotting (because it makes it possible to call the
function with a vector argument to produce a vector result).

   <p>Then we simply call quad:

<pre class="example">     [v, ier, nfun, err] = quad ("f", 0, 3)
          =&gt; 1.9819
          =&gt; 1
          =&gt; 5061
          =&gt; 1.1522e-07
</pre>
   <p>Although <code>quad</code> returns a nonzero value for <var>ier</var>, the result
is reasonably accurate (to see why, examine what happens to the result
if you move the lower bound to 0.1, then 0.01, then 0.001, etc.).

   <p><a name="doc_002dquadl"></a>

<div class="defun">
&mdash; Function File: <var>q</var> = <b>quadl</b> (<var>f, a, b</var>)<var><a name="index-quadl-1246"></a></var><br>
&mdash; Function File: <var>q</var> = <b>quadl</b> (<var>f, a, b, tol</var>)<var><a name="index-quadl-1247"></a></var><br>
&mdash; Function File: <var>q</var> = <b>quadl</b> (<var>f, a, b, tol, trace</var>)<var><a name="index-quadl-1248"></a></var><br>
&mdash; Function File: <var>q</var> = <b>quadl</b> (<var>f, a, b, tol, trace, p1, p2, <small class="dots">...</small></var>)<var><a name="index-quadl-1249"></a></var><br>
<blockquote>
<p>Numerically evaluate integral using adaptive Lobatto rule. 
<code>quadl (</code><var>f</var><code>, </code><var>a</var><code>, </code><var>b</var><code>)</code> approximates the integral of
<var>f</var><code>(</code><var>x</var><code>)</code> to machine precision. <var>f</var> is either a
function handle, inline function or string containing the name of
the function to evaluate. The function <var>f</var> must return a vector
of output values if given a vector of input values.

        <p>If defined, <var>tol</var> defines the relative tolerance to which to
which to integrate <var>f</var><code>(</code><var>x</var><code>)</code>. While if <var>trace</var> is
defined, displays the left end point of the current interval, the
interval length, and the partial integral.

        <p>Additional arguments <var>p1</var>, etc, are passed directly to <var>f</var>. 
To use default values for <var>tol</var> and <var>trace</var>, one may pass
empty matrices.

        <p>Reference: W. Gander and W. Gautschi, 'Adaptive Quadrature -
Revisited', BIT Vol. 40, No. 1, March 2000, pp. 84&ndash;101. 
<a href="http://www.inf.ethz.ch/personal/gander/">http://www.inf.ethz.ch/personal/gander/</a>

        </blockquote></div>

   <p><a name="doc_002dtrapz"></a>

<div class="defun">
&mdash; Function File: <var>z</var> = <b>trapz</b> (<var>y</var>)<var><a name="index-trapz-1250"></a></var><br>
&mdash; Function File: <var>z</var> = <b>trapz</b> (<var>x, y</var>)<var><a name="index-trapz-1251"></a></var><br>
&mdash; Function File: <var>z</var> = <b>trapz</b> (<var><small class="dots">...</small>, dim</var>)<var><a name="index-trapz-1252"></a></var><br>
<blockquote>
<p>Numerical intergration using trapezodial method. <code>trapz
(</code><var>y</var><code>)</code> computes the integral of the <var>y</var> along the first
non singleton dimension. If the argument <var>x</var> is omitted a
equally spaced vector is assumed. <code>trapz (</code><var>x</var><code>, </code><var>y</var><code>)</code>
evaluates the integral with respect to <var>x</var>.

        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> cumtrapz. 
</p></blockquote></div>

   <p><a name="doc_002dcumtrapz"></a>

<div class="defun">
&mdash; Function File: <var>z</var> = <b>cumtrapz</b> (<var>y</var>)<var><a name="index-cumtrapz-1253"></a></var><br>
&mdash; Function File: <var>z</var> = <b>cumtrapz</b> (<var>x, y</var>)<var><a name="index-cumtrapz-1254"></a></var><br>
&mdash; Function File: <var>z</var> = <b>cumtrapz</b> (<var><small class="dots">...</small>, dim</var>)<var><a name="index-cumtrapz-1255"></a></var><br>
<blockquote>
<p>Cumulative numerical intergration using trapezodial method. 
<code>cumtrapz (</code><var>y</var><code>)</code> computes the cummulative integral of the
<var>y</var> along the first non singleton dimension. If the argument
<var>x</var> is omitted a equally spaced vector is assumed. <code>cumtrapz
(</code><var>x</var><code>, </code><var>y</var><code>)</code> evaluates the cummulative integral with respect
to <var>x</var>.

        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> trapz,cumsum. 
</p></blockquote></div>

   </body></html>

