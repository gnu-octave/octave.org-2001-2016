<html lang="en">
<head>
<title>Polynomial Manipulations - Untitled</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Untitled">
<meta name="generator" content="makeinfo 4.8">
<link title="Top" rel="start" href="index.html#Top">
<link rel="prev" href="Sets.html#Sets" title="Sets">
<link rel="next" href="Interpolation.html#Interpolation" title="Interpolation">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<p>
<a name="Polynomial-Manipulations"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="Interpolation.html#Interpolation">Interpolation</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Sets.html#Sets">Sets</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="index.html#Top">Top</a>
<hr>
</div>

<h2 class="chapter">29 Polynomial Manipulations</h2>

<p>In Octave, a polynomial is represented by its coefficients (arranged
in descending order).  For example, a vector
 $c$
of length
 <var>N</var>

<pre class="example">     p(x) = <var>c</var>(1) x^<var>N</var> + ... + <var>c</var>(<var>N</var>) x + <var>c</var>(<var>N</var>+1).
</pre>
   <p><a name="doc_002dcompan"></a>

<div class="defun">
&mdash; Function File:  <b>compan</b> (<var>c</var>)<var><a name="index-compan-1474"></a></var><br>
<blockquote><p>Compute the companion matrix corresponding to polynomial coefficient
vector <var>c</var>.

        <p>The companion matrix is

     <pre class="smallexample">               _                                                        _
              |  -c(2)/c(1)   -c(3)/c(1)  ...  -c(N)/c(1)  -c(N+1)/c(1)  |
              |       1            0      ...       0             0      |
              |       0            1      ...       0             0      |
          A = |       .            .   .            .             .      |
              |       .            .       .        .             .      |
              |       .            .           .    .             .      |
              |_      0            0      ...       1             0     _|
     </pre>
        <p>The eigenvalues of the companion matrix are equal to the roots of the
polynomial.
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> poly, roots, residue, conv, deconv, polyval, polyderiv,
polyinteg. 
</p></blockquote></div>

   <p><a name="doc_002dconv"></a>

<div class="defun">
&mdash; Function File:  <b>conv</b> (<var>a, b</var>)<var><a name="index-conv-1475"></a></var><br>
<blockquote><p>Convolve two vectors.

        <p><code>y = conv (a, b)</code> returns a vector of length equal to
<code>length (a) + length (b) - 1</code>. 
If <var>a</var> and <var>b</var> are polynomial coefficient vectors, <code>conv</code>
returns the coefficients of the product polynomial.
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> deconv, poly, roots, residue, polyval, polyderiv, polyinteg. 
</p></blockquote></div>

   <p><a name="doc_002ddeconv"></a>

<div class="defun">
&mdash; Function File:  <b>deconv</b> (<var>y, a</var>)<var><a name="index-deconv-1476"></a></var><br>
<blockquote><p>Deconvolve two vectors.

        <p><code>[b, r] = deconv (y, a)</code> solves for <var>b</var> and <var>r</var> such that
<code>y = conv (a, b) + r</code>.

        <p>If <var>y</var> and <var>a</var> are polynomial coefficient vectors, <var>b</var> will
contain the coefficients of the polynomial quotient and <var>r</var> will be
a remander polynomial of lowest order.
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> conv, poly, roots, residue, polyval, polyderiv, polyinteg. 
</p></blockquote></div>

   <p><a name="doc_002dconv2"></a>

<div class="defun">
&mdash; Loadable Function: y = <b>conv2</b> (<var>a, b, shape</var>)<var><a name="index-conv2-1477"></a></var><br>
&mdash; Loadable Function: y = <b>conv2</b> (<var>v1, v2, M, shape</var>)<var><a name="index-conv2-1478"></a></var><br>
<blockquote>
<p>Returns 2D convolution of <var>a</var> and <var>b</var> where the size
of <var>c</var> is given by

          <dl>
<dt><var>shape</var>= 'full'<dd>returns full 2-D convolution
<br><dt><var>shape</var>= 'same'<dd>same size as a. 'central' part of convolution
<br><dt><var>shape</var>= 'valid'<dd>only parts which do not include zero-padded edges
</dl>

        <p>By default <var>shape</var> is 'full'. When the third argument is a matrix
returns the convolution of the matrix <var>M</var> by the vector <var>v1</var>
in the column direction and by vector <var>v2</var> in the row direction
</p></blockquote></div>

   <p><a name="doc_002dpoly"></a>

<div class="defun">
&mdash; Function File:  <b>poly</b> (<var>a</var>)<var><a name="index-poly-1479"></a></var><br>
<blockquote><p>If <var>a</var> is a square N-by-N matrix, <code>poly (</code><var>a</var><code>)</code>
is the row vector of the coefficients of <code>det (z * eye (N) - a)</code>,
the characteristic polynomial of <var>a</var>.  If <var>x</var> is a vector,
<code>poly (</code><var>x</var><code>)</code> is a vector of coefficients of the polynomial
whose roots are the elements of <var>x</var>. 
</p></blockquote></div>

   <p><a name="doc_002dpolyderiv"></a>

<div class="defun">
&mdash; Function File:  <b>polyderiv</b> (<var>c</var>)<var><a name="index-polyderiv-1480"></a></var><br>
&mdash; Function File: [<var>q</var>] = <b>polyder</b> (<var>b, a</var>)<var><a name="index-polyder-1481"></a></var><br>
&mdash; Function File: [<var>q</var>, <var>r</var>] = <b>polyder</b> (<var>b, a</var>)<var><a name="index-polyder-1482"></a></var><br>
<blockquote><p>Return the coefficients of the derivative of the polynomial whose
coefficients are given by vector <var>c</var>.  If a pair of polynomials
is given <var>b</var> and <var>a</var>, the derivative of the product is
returned in <var>q</var>, or the quotient numerator in <var>q</var> and the
quotient denominator in <var>r</var>.
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> poly, polyinteg, polyreduce, roots, conv, deconv, residue,
filter, polygcd, polyval, polyvalm. 
</p></blockquote></div>

   <p><a name="doc_002dpolyder"></a>

<div class="defun">
&mdash; Function File:  <b>polyder</b> (<var>c</var>)<var><a name="index-polyder-1483"></a></var><br>
&mdash; Function File: [<var>q</var>] = <b>polyder</b> (<var>b, a</var>)<var><a name="index-polyder-1484"></a></var><br>
&mdash; Function File: [<var>q</var>, <var>r</var>] = <b>polyder</b> (<var>b, a</var>)<var><a name="index-polyder-1485"></a></var><br>
<blockquote><p>See polyderiv. 
</p></blockquote></div>

   <p><a name="doc_002dpolyfit"></a>

<div class="defun">
&mdash; Function File: [<var>p</var>, <var>s</var>] = <b>polyfit</b> (<var>x, y, n</var>)<var><a name="index-polyfit-1486"></a></var><br>
<blockquote><p>Return the coefficients of a polynomial <var>p</var>(<var>x</var>) of degree
<var>n</var> that minimizes
<code>sumsq (p(x(i)) - y(i))</code>,
 to best fit the data in the least squares sense.

        <p>The polynomial coefficients are returned in a row vector.

        <p>If two output arguments are requested, the second is a structure
containing the following fields:

          <dl>
<dt><code>R</code><dd>The Cholesky factor of the Vandermonde matrix used to compute the
polynomial coefficients. 
<br><dt><code>X</code><dd>The Vandermonde matrix used to compute the polynomial coefficients. 
<br><dt><code>df</code><dd>The degrees of freedom. 
<br><dt><code>normr</code><dd>The norm of the residuals. 
<br><dt><code>yf</code><dd>The values of the polynomial for each value of <var>x</var>. 
</dl>
        </p></blockquote></div>

   <p><a name="doc_002dpolygcd"></a>

<div class="defun">
&mdash; Function File: <var>q</var> = <b>polygcd</b> (<var>b, a, tol</var>)<var><a name="index-polygcd-1487"></a></var><br>
<blockquote>
<p>Find greatest common divisor of two polynomials.  This is equivalent
to the polynomial found by multiplying together all the common roots. 
Together with deconv, you can reduce a ratio of two polynomials. 
Tolerance defaults to
     <pre class="example">          sqrt(eps).
     </pre>
        <p>Note that this is an unstable
algorithm, so don't try it on large polynomials.

        <p>Example
     <pre class="example">          polygcd (poly(1:8), poly(3:12)) - poly(3:8)
                   deconv (poly(1:8), polygcd (poly(1:8), poly(3:12))) - poly(1:2)
     </pre>
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> poly, polyinteg, polyderiv, polyreduce, roots, conv, deconv,
residue, filter, polyval, and polyvalm. 
</p></blockquote></div>

   <p><a name="doc_002dpolyinteg"></a>

<div class="defun">
&mdash; Function File:  <b>polyinteg</b> (<var>c</var>)<var><a name="index-polyinteg-1488"></a></var><br>
<blockquote><p>Return the coefficients of the integral of the polynomial whose
coefficients are represented by the vector <var>c</var>.

        <p>The constant of integration is set to zero.
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> poly, polyderiv, polyreduce, roots, conv, deconv, residue,
filter, polyval, and polyvalm. 
</p></blockquote></div>

   <p><a name="doc_002dpolyreduce"></a>

<div class="defun">
&mdash; Function File:  <b>polyreduce</b> (<var>c</var>)<var><a name="index-polyreduce-1489"></a></var><br>
<blockquote><p>Reduces a polynomial coefficient vector to a minimum number of terms by
stripping off any leading zeros.
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> poly, roots, conv, deconv, residue, filter, polyval,
polyvalm, polyderiv, polyinteg. 
</p></blockquote></div>

   <p><a name="doc_002dpolyval"></a>

<div class="defun">
&mdash; Function File:  <b>polyval</b> (<var>c, x</var>)<var><a name="index-polyval-1490"></a></var><br>
<blockquote><p>Evaluate a polynomial.

        <p><code>polyval (</code><var>c</var><code>, </code><var>x</var><code>)</code> will evaluate the polynomial at the
specified value of <var>x</var>.

        <p>If <var>x</var> is a vector or matrix, the polynomial is evaluated at each of
the elements of <var>x</var>.
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> polyvalm, poly, roots, conv, deconv, residue, filter,
polyderiv, polyinteg. 
</p></blockquote></div>

   <p><a name="doc_002dpolyvalm"></a>

<div class="defun">
&mdash; Function File:  <b>polyvalm</b> (<var>c, x</var>)<var><a name="index-polyvalm-1491"></a></var><br>
<blockquote><p>Evaluate a polynomial in the matrix sense.

        <p><code>polyvalm (</code><var>c</var><code>, </code><var>x</var><code>)</code> will evaluate the polynomial in the
matrix sense, i.e. matrix multiplication is used instead of element by
element multiplication as is used in polyval.

        <p>The argument <var>x</var> must be a square matrix.
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> polyval, poly, roots, conv, deconv, residue, filter,
polyderiv, and polyinteg. 
</p></blockquote></div>

   <p><a name="doc_002dresidue"></a>

<div class="defun">
&mdash; Function File:  <b>residue</b> (<var>b, a, tol</var>)<var><a name="index-residue-1492"></a></var><br>
<blockquote><p>If <var>b</var> and <var>a</var> are vectors of polynomial coefficients, then
residue calculates the partial fraction expansion corresponding to the
ratio of the two polynomials. 
<a name="index-partial-fraction-expansion-1493"></a>
The function <code>residue</code> returns <var>r</var>, <var>p</var>, <var>k</var>, and
<var>e</var>, where the vector <var>r</var> contains the residue terms, <var>p</var>
contains the pole values, <var>k</var> contains the coefficients of a direct
polynomial term (if it exists) and <var>e</var> is a vector containing the
powers of the denominators in the partial fraction terms.

        <p>Assuming <var>b</var> and <var>a</var> represent polynomials
 P (s) and Q(s)
 we have:

     <pre class="example">           P(s)    M       r(m)         N
           ---- = SUM -------------  + SUM k(i)*s^(N-i)
           Q(s)   m=1 (s-p(m))^e(m)    i=1
     </pre>
        <p class="noindent">where M is the number of poles (the length of the <var>r</var>,
<var>p</var>, and <var>e</var> vectors) and N is the length of the
<var>k</var> vector.

        <p>The argument <var>tol</var> is optional, and if not specified, a default
value of 0.001 is assumed.  The tolerance value is used to determine
whether poles with small imaginary components are declared real.  It is
also used to determine if two poles are distinct.  If the ratio of the
imaginary part of a pole to the real part is less than <var>tol</var>, the
imaginary part is discarded.  If two poles are farther apart than
<var>tol</var> they are distinct.  For example,

     <pre class="example">           b = [1, 1, 1];
           a = [1, -5, 8, -4];
           [r, p, k, e] = residue (b, a);
          =&gt; r = [-2, 7, 3]
          =&gt; p = [2, 2, 1]
          =&gt; k = [](0x0)
          =&gt; e = [1, 2, 1]
     </pre>
        <p class="noindent">which implies the following partial fraction expansion

     <pre class="example">                  s^2 + s + 1       -2        7        3
             ------------------- = ----- + ------- + -----
             s^3 - 5s^2 + 8s - 4   (s-2)   (s-2)^2   (s-1)
     </pre>
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> poly, roots, conv, deconv, polyval, polyderiv, and polyinteg. 
</p></blockquote></div>

   <p><a name="doc_002droots"></a>

<div class="defun">
&mdash; Function File:  <b>roots</b> (<var>v</var>)<var><a name="index-roots-1494"></a></var><br>
<blockquote>
<p>For a vector <var>v</var> with N components, return
the roots of the polynomial

     <pre class="example">          v(1) * z^(N-1) + ... + v(N-1) * z + v(N)
     </pre>
        </blockquote></div>

   <p><a name="doc_002dpolyout"></a>

<div class="defun">
&mdash; Function File:  <b>polyout</b> (<var>c, x</var>)<var><a name="index-polyout-1495"></a></var><br>
<blockquote><p>Write formatted polynomial
     <pre class="example">             c(x) = c(1) * x^n + ... + c(n) x + c(n+1)
     </pre>
        <p>and return it as a string or write it to the screen (if
<var>nargout</var> is zero). 
<var>x</var> defaults to the string <code>"s"</code>.
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> polyval, polyvalm, poly, roots, conv, deconv, residue,
filter, polyderiv, and polyinteg. 
</p></blockquote></div>

   <p><a name="doc_002dppval"></a>

<div class="defun">
&mdash; Function File: <var>yi</var> = <b>ppval</b> (<var>pp, xi</var>)<var><a name="index-ppval-1496"></a></var><br>
<blockquote><p>Evaluate piece-wise polynomial <var>pp</var> at the points <var>xi</var>. 
If <var>pp</var><code>.d</code> is a scalar greater than 1, or an array,
then the returned value <var>yi</var> will be an array that is
<code>d1, d1, ..., dk, length (</code><var>xi</var><code>)]</code>.
        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> mkpp, unmkpp, spline. 
</p></blockquote></div>

   <p><a name="doc_002dmkpp"></a>

<div class="defun">
&mdash; Function File: <var>pp</var> = <b>mkpp</b> (<var>x, p</var>)<var><a name="index-mkpp-1497"></a></var><br>
&mdash; Function File: <var>pp</var> = <b>mkpp</b> (<var>x, p, d</var>)<var><a name="index-mkpp-1498"></a></var><br>
<blockquote>
<p>Construct a piece-wise polynomial structure from sample points
<var>x</var> and coefficients <var>p</var>.  The ith row of <var>p</var>,
<var>p</var><code> (</code><var>i</var><code>,:)</code>, contains the coefficients for the polynomial
over the <var>i</var>-th interval, ordered from highest to
lowest. There must be one row for each interval in <var>x</var>, so
<code>rows (</code><var>p</var><code>) == length (</code><var>x</var><code>) - 1</code>.

        <p>You can concatenate multiple polynomials of the same order over the
same set of intervals using <var>p</var><code> = [ </code><var>p1</var><code>; </code><var>p2</var><code>;
...; </code><var>pd</var><code> ]</code>.  In this case, <code>rows (</code><var>p</var><code>) == </code><var>d</var><code>
* (length (</code><var>x</var><code>) - 1)</code>.

        <p><var>d</var> specifies the shape of the matrix <var>p</var> for all except the
last dimension. If <var>d</var> is not specified it will be computed as
<code>round (rows (</code><var>p</var><code>) / (length (</code><var>x</var><code>) - 1))</code> instead.

        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> unmkpp, ppval, spline. 
</p></blockquote></div>

   <p><a name="doc_002dunmkpp"></a>

<div class="defun">
&mdash; Function File: [<var>x</var>, <var>p</var>, <var>n</var>, <var>k</var>, <var>d</var>] = <b>unmkpp</b> (<var>pp</var>)<var><a name="index-unmkpp-1499"></a></var><br>
<blockquote>
<p>Extract the components of a piece-wise polynomial structure <var>pp</var>. 
These are as follows:

          <dl>
<dt><var>x</var><dd>Samples points. 
<br><dt><var>p</var><dd>Polynomial coefficients for points in sample interval. <var>p</var><code>
(</code><var>i</var><code>, :)</code> contains the coefficients for the polynomial over
interval <var>i</var> ordered from highest to lowest. If <var>d</var><code> &gt;
1</code>, <var>p</var><code> (</code><var>r</var><code>, </code><var>i</var><code>, :)</code> contains the coeffients for
the r-th polynomial defined on interval <var>i</var>. However, this is
stored as a 2-D array such that <var>c</var><code> = reshape (</code><var>p</var><code> (:,
</code><var>j</var><code>), </code><var>n</var><code>, </code><var>d</var><code>)</code> gives <var>c</var><code> (</code><var>i</var><code>,  </code><var>r</var><code>)</code>
is the j-th coefficient of the r-th polynomial over the i-th interval. 
<br><dt><var>n</var><dd>Number of polynomial pieces. 
<br><dt><var>k</var><dd>Order of the polynomial plus 1. 
<br><dt><var>d</var><dd>Number of polynomials defined for each interval. 
</dl>

        <pre class="sp">
     
     </pre>
     <strong>See also:</strong> mkpp, ppval, spline. 
</p></blockquote></div>

<!-- DO NOT EDIT!  Generated automatically by munge-texi. -->
<!-- Copyright (C) 2007 John W. Eaton -->
<!-- This is part of the Octave manual. -->
<!-- For copying conditions, see the file gpl.texi. -->
</body></html>

